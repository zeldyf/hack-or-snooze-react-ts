{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport { autoLogin, signup, loginUser } from \"../fetchUser\";\nimport { addOrDeleteFavorite, newStory } from \"../fetchStories\";\nconst initialState = {\n  createdAt: \"\",\n  favorites: [],\n  name: \"\",\n  stories: [],\n  updatedAt: \"\",\n  username: \"\",\n  status: \"idle\"\n};\nexport const userSlice = createSlice({\n  name: \"user\",\n  initialState,\n  reducers: {\n    logout: state => {\n      state.createdAt = \"\";\n      state.favorites = [];\n      state.name = \"\";\n      state.stories = [];\n      state.updatedAt = \"\";\n      state.username = \"\";\n      state.status = \"idle\";\n      localStorage.clear();\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(signup.pending, state => {\n      state.status = \"loading\";\n    }).addCase(signup.fulfilled, (state, action) => {\n      state.username = action.payload.user.username;\n      state.updatedAt = action.payload.user.updatedAt;\n      state.createdAt = action.payload.user.createdAt;\n      state.favorites = action.payload.user.favorites;\n      state.name = action.payload.user.name;\n      state.stories = action.payload.user.stories;\n      state.status = \"succeeded\";\n      localStorage.setItem('token', action.payload.token);\n      localStorage.setItem('username', action.payload.user.username);\n    }).addCase(signup.rejected, state => {\n      state.status = \"failed\";\n    }).addCase(loginUser.pending, state => {\n      state.status = \"loading\";\n    }).addCase(loginUser.fulfilled, (state, action) => {\n      state.username = action.payload.user.username;\n      state.updatedAt = action.payload.user.updatedAt;\n      state.createdAt = action.payload.user.createdAt;\n      state.favorites = action.payload.user.favorites;\n      state.name = action.payload.user.name;\n      state.stories = action.payload.user.stories;\n      state.status = \"succeeded\";\n      localStorage.setItem('token', action.payload.token);\n      localStorage.setItem('username', action.payload.user.username);\n    }).addCase(autoLogin.pending, state => {\n      state.status = 'loading';\n    }).addCase(autoLogin.fulfilled, (state, action) => {\n      state.username = action.payload.user.username;\n      state.updatedAt = action.payload.user.updatedAt;\n      state.createdAt = action.payload.user.createdAt;\n      state.favorites = action.payload.user.favorites;\n      state.name = action.payload.user.name;\n      state.stories = action.payload.user.stories;\n      state.status = \"succeeded\";\n    }).addCase(newStory.fulfilled, (state, action) => {\n      console.log(action.payload);\n      state.stories.push(action.payload.story);\n    }).addCase(addOrDeleteFavorite.fulfilled, (state, action) => {\n      console.log(action);\n      if (action.meta.arg.fetchMethod === \"add\") {\n        state.favorites.push(action.payload.story);\n      } else {\n        state.favorites = state.favorites.filter(story => action.payload.story.storyId);\n      }\n    });\n  }\n});\nexport const {\n  logout\n} = userSlice.actions;\nexport const userReducer = userSlice.reducer;","map":{"version":3,"names":["createSlice","autoLogin","signup","loginUser","addOrDeleteFavorite","newStory","initialState","createdAt","favorites","name","stories","updatedAt","username","status","userSlice","reducers","logout","state","localStorage","clear","extraReducers","builder","addCase","pending","fulfilled","action","payload","user","setItem","token","rejected","console","log","push","story","meta","arg","fetchMethod","filter","storyId","actions","userReducer","reducer"],"sources":["/Users/zeldyfriedman/Documents/Redux/hack-or-snooze-react-ts/src/store/userSlice.ts"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\nimport { autoLogin, signup, loginUser } from \"../fetchUser\";\nimport { addOrDeleteFavorite, newStory } from \"../fetchStories\";\nimport { StoryObj } from \"./types\";\n\nconst initialState = {\n    createdAt: \"\",\n    favorites: [] as StoryObj[],\n    name: \"\",\n    stories: [] as StoryObj[],\n    updatedAt: \"\",\n    username: \"\",\n    status: \"idle\",\n};\n\nexport const userSlice = createSlice({\n    name: \"user\",\n    initialState,\n    reducers: {\n        logout: (state) => {\n            state.createdAt = \"\";\n            state.favorites = [];\n            state.name = \"\";\n            state.stories = [];\n            state.updatedAt = \"\";\n            state.username = \"\";\n            state.status = \"idle\";\n\n            localStorage.clear();\n        },\n    },\n    extraReducers: (builder) => {\n        builder\n            .addCase(signup.pending, (state) => {\n                state.status = \"loading\"\n            })\n            .addCase(signup.fulfilled, (state, action) => {\n                state.username = action.payload.user.username;\n                state.updatedAt = action.payload.user.updatedAt;\n                state.createdAt = action.payload.user.createdAt;\n                state.favorites = action.payload.user.favorites;\n                state.name = action.payload.user.name;\n                state.stories = action.payload.user.stories;\n                state.status = \"succeeded\"\n\n                localStorage.setItem('token', action.payload.token);\n                localStorage.setItem('username', action.payload.user.username);\n            })\n            .addCase(signup.rejected, (state) => {\n                state.status = \"failed\"\n            })\n            .addCase(loginUser.pending, (state) => {\n                state.status = \"loading\"\n            })\n            .addCase(loginUser.fulfilled, (state, action) => {\n                state.username = action.payload.user.username;\n                state.updatedAt = action.payload.user.updatedAt;\n                state.createdAt = action.payload.user.createdAt;\n                state.favorites = action.payload.user.favorites;\n                state.name = action.payload.user.name;\n                state.stories = action.payload.user.stories;\n                state.status = \"succeeded\"\n\n                localStorage.setItem('token', action.payload.token);\n                localStorage.setItem('username', action.payload.user.username);\n            })\n            .addCase(autoLogin.pending, (state) => {\n                state.status = 'loading'\n            })\n            .addCase(autoLogin.fulfilled, (state, action) => {\n                state.username = action.payload.user.username;\n                state.updatedAt = action.payload.user.updatedAt;\n                state.createdAt = action.payload.user.createdAt;\n                state.favorites = action.payload.user.favorites;\n                state.name = action.payload.user.name;\n                state.stories = action.payload.user.stories;\n                state.status = \"succeeded\"\n            })\n            .addCase(newStory.fulfilled, (state, action) => {\n                console.log(action.payload)\n                state.stories.push(action.payload.story)\n            })\n            .addCase(addOrDeleteFavorite.fulfilled, (state, action) => {\n                console.log(action);\n                if (action.meta.arg.fetchMethod === \"add\") {\n                    state.favorites.push(action.payload.story)\n                } else {\n                    state.favorites = state.favorites.filter(story => action.payload.story.storyId)\n                }\n            });\n    },\n});\n\nexport const { logout } = userSlice.actions;\nexport const userReducer = userSlice.reducer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}