{"ast":null,"code":"import _regeneratorRuntime from\"/Users/zeldyfriedman/Documents/Redux/hack-or-snooze-react-ts/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/zeldyfriedman/Documents/Redux/hack-or-snooze-react-ts/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{createAsyncThunk}from\"@reduxjs/toolkit\";export var BASE_URL=\"https://hack-or-snooze-v3.herokuapp.com\";var storedUsername=localStorage.getItem(\"username\");var storedToken=localStorage.getItem(\"token\");export var fetchStories=createAsyncThunk(\"stories/fetchStories\",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(BASE_URL+\"/stories\").then(function(response){return response.json();});case 2:response=_context.sent;console.log(response.stories);return _context.abrupt(\"return\",response.stories);case 5:case\"end\":return _context.stop();}},_callee);})));export var newStory=createAsyncThunk(\"stories/newStory\",/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref2){var author,title,url,response,storyData;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:author=_ref2.author,title=_ref2.title,url=_ref2.url;_context2.next=3;return fetch(BASE_URL+\"/stories\",{method:\"POST\",body:JSON.stringify({token:storedToken,story:{author:author,title:title,url:url}})});case 3:response=_context2.sent;if(response.ok){_context2.next=6;break;}throw new Error(\"New story failed\");case 6:_context2.next=8;return response.json();case 8:storyData=_context2.sent;console.log(\"New story added\",storyData);return _context2.abrupt(\"return\",storyData);case 11:case\"end\":return _context2.stop();}},_callee2);}));return function(_x){return _ref3.apply(this,arguments);};}());export var addOrDeleteFavorite=createAsyncThunk(\"stories/addOrDeleteFavorite\",/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(_ref4){var fetchMethod,storyId,response,userData;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:fetchMethod=_ref4.fetchMethod,storyId=_ref4.storyId;_context3.next=3;return fetch(\"\".concat(BASE_URL,\"/users/\").concat(storedUsername,\"/favorites/\").concat(storyId),{method:fetchMethod===\"add\"?\"POST\":\"DELETE\",body:JSON.stringify({token:storedToken})});case 3:response=_context3.sent;if(response.ok){_context3.next=6;break;}throw new Error(\"\".concat(fetchMethod,\" favorite failed\"));case 6:_context3.next=8;return response.json();case 8:userData=_context3.sent;return _context3.abrupt(\"return\",userData);case 10:case\"end\":return _context3.stop();}},_callee3);}));return function(_x2){return _ref5.apply(this,arguments);};}());export var deleteStory=createAsyncThunk(\"stories/deleteStory\",/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(_ref6){var storyId,response,userData;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:storyId=_ref6.storyId;_context4.next=3;return fetch(\"\".concat(BASE_URL,\"/stories/\").concat(storyId),{method:\"DELETE\",body:JSON.stringify({token:storedToken})});case 3:response=_context4.sent;if(response.ok){_context4.next=6;break;}throw new Error(\"Delete failed\");case 6:_context4.next=8;return response.json();case 8:userData=_context4.sent;return _context4.abrupt(\"return\",userData);case 10:case\"end\":return _context4.stop();}},_callee4);}));return function(_x3){return _ref7.apply(this,arguments);};}());export default fetchStories;","map":{"version":3,"names":["createAsyncThunk","BASE_URL","storedUsername","localStorage","getItem","storedToken","fetchStories","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","fetch","then","json","sent","console","log","stories","abrupt","stop","newStory","_ref3","_callee2","_ref2","author","title","url","storyData","_callee2$","_context2","method","body","JSON","stringify","token","story","ok","Error","_x","apply","arguments","addOrDeleteFavorite","_ref5","_callee3","_ref4","fetchMethod","storyId","userData","_callee3$","_context3","concat","_x2","deleteStory","_ref7","_callee4","_ref6","_callee4$","_context4","_x3"],"sources":["/Users/zeldyfriedman/Documents/Redux/hack-or-snooze-react-ts/src/store/fetchStories.tsx"],"sourcesContent":["import { createAsyncThunk } from \"@reduxjs/toolkit\";\n\nexport const BASE_URL = \"https://hack-or-snooze-v3.herokuapp.com\";\nconst storedUsername = localStorage.getItem(\"username\");\nconst storedToken = localStorage.getItem(\"token\");\n\nexport const fetchStories = createAsyncThunk(\n  `stories/fetchStories`,\n  async () => {\n    const response = await fetch(BASE_URL + \"/stories\").then((response) =>\n      response.json()\n    );\n    console.log(response.stories);\n    return response.stories;\n  }\n);\n\nexport const newStory = createAsyncThunk(\n  \"stories/newStory\",\n  async ({\n    author,\n    title,\n    url,\n  }: {\n    author: string;\n    title: string;\n    url: string;\n  }) => {\n    const response = await fetch(BASE_URL + \"/stories\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        token: storedToken,\n        story: {\n          author,\n          title,\n          url,\n        },\n      }),\n    });\n    if (!response.ok) {\n      throw new Error(\"New story failed\");\n    }\n\n    const storyData = await response.json();\n    console.log(\"New story added\", storyData);\n    return storyData;\n  }\n);\n\nexport const addOrDeleteFavorite = createAsyncThunk(\n  \"stories/addOrDeleteFavorite\",\n  async ({\n    fetchMethod,\n    storyId,\n  }: {\n    fetchMethod: \"add\" | \"delete\";\n    storyId: string;\n  }) => {\n    const response = await fetch(\n      `${BASE_URL}/users/${storedUsername}/favorites/${storyId}`,\n      {\n        method: fetchMethod === \"add\" ? \"POST\" : \"DELETE\",\n        body: JSON.stringify({\n          token: storedToken,\n        }),\n      }\n    );\n    if (!response.ok) {\n      throw new Error(`${fetchMethod} favorite failed`);\n    }\n    const userData = await response.json();\n    return userData;\n  }\n);\n\nexport const deleteStory = createAsyncThunk(\n  \"stories/deleteStory\",\n  async ({ storyId }: { storyId: string }) => {\n    const response = await fetch(`${BASE_URL}/stories/${storyId}`, {\n      method: \"DELETE\",\n      body: JSON.stringify({\n        token: storedToken,\n      }),\n    });\n    if (!response.ok) {\n      throw new Error(\"Delete failed\");\n    }\n    const userData = await response.json();\n    return userData;\n  }\n);\n\nexport default fetchStories;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}