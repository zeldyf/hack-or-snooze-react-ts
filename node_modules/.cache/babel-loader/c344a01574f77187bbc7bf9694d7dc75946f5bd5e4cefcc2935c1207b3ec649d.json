{"ast":null,"code":"import _regeneratorRuntime from\"/Users/zeldyfriedman/Documents/Redux/hack-or-snooze-react-ts/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/zeldyfriedman/Documents/Redux/hack-or-snooze-react-ts/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{createAsyncThunk}from\"@reduxjs/toolkit\";export var BASE_URL=\"https://hack-or-snooze-v3.herokuapp.com\";export var signup=createAsyncThunk(\"user/signup\",/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref){var username,password,name,response,userData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:username=_ref.username,password=_ref.password,name=_ref.name;_context.next=3;return fetch(BASE_URL+\"/signup\",{method:\"POST\",body:JSON.stringify({user:{password:password,username:username,name:name}})});case 3:response=_context.sent;console.log(response);if(response.ok){_context.next=7;break;}throw new Error(\"Signup failed\");case 7:_context.next=9;return response.json();case 9:userData=_context.sent;console.log(\"User data on signup:\",userData);return _context.abrupt(\"return\",userData);case 12:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());export var loginUser=createAsyncThunk(\"user/login\",/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref3){var username,password,response,userData;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:username=_ref3.username,password=_ref3.password;_context2.next=3;return fetch(BASE_URL+\"/login\",{method:\"POST\",body:JSON.stringify({user:{password:password,username:username}})});case 3:response=_context2.sent;console.log(response);if(response.ok){_context2.next=7;break;}throw new Error(\"Login failed\");case 7:_context2.next=9;return response.json();case 9:userData=_context2.sent;console.log(\"User data on login:\",userData);return _context2.abrupt(\"return\",userData);case 12:case\"end\":return _context2.stop();}},_callee2);}));return function(_x2){return _ref4.apply(this,arguments);};}());export var autoLogin=createAsyncThunk(\"user/autoLogin\",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var username,token,response,userData;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:username=localStorage.getItem(\"username\");token=localStorage.getItem(\"token\");_context3.next=4;return fetch(\"\".concat(BASE_URL,\"/users/\").concat(username,\"?token=\").concat(token),{method:\"GET\"});case 4:response=_context3.sent;if(response.ok){_context3.next=7;break;}throw new Error(\"Login failed\");case 7:_context3.next=9;return response.json();case 9:userData=_context3.sent;console.log(\"User data on login:\",userData);return _context3.abrupt(\"return\",userData);case 12:case\"end\":return _context3.stop();}},_callee3);})));export default loginUser;","map":{"version":3,"names":["createAsyncThunk","BASE_URL","signup","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","username","password","name","response","userData","wrap","_callee$","_context","prev","next","fetch","method","body","JSON","stringify","user","sent","console","log","ok","Error","json","abrupt","stop","_x","apply","arguments","loginUser","_ref4","_callee2","_ref3","_callee2$","_context2","_x2","autoLogin","_callee3","token","_callee3$","_context3","localStorage","getItem","concat"],"sources":["/Users/zeldyfriedman/Documents/Redux/hack-or-snooze-react-ts/src/store/fetchUser.tsx"],"sourcesContent":["import { createAsyncThunk } from \"@reduxjs/toolkit\";\n\nexport const BASE_URL = \"https://hack-or-snooze-v3.herokuapp.com\";\n\nexport const signup = createAsyncThunk(\n  `user/signup`,\n  async ({\n    username,\n    password,\n    name,\n  }: {\n    username: string;\n    password: string;\n    name: string;\n  }) => {\n    const response = await fetch(BASE_URL + \"/signup\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        user: {\n          password,\n          username,\n          name,\n        },\n      }),\n    });\n    console.log(response);\n    if (!response.ok) {\n      throw new Error(\"Signup failed\");\n    }\n\n    const userData = await response.json();\n    console.log(\"User data on signup:\", userData);\n\n    return userData;\n  }\n);\n\nexport const loginUser = createAsyncThunk(\n  `user/login`,\n  async ({ username, password }: { username: string; password: string }) => {\n    const response = await fetch(BASE_URL + \"/login\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        user: {\n          password,\n          username,\n        },\n      }),\n    });\n    console.log(response);\n    if (!response.ok) {\n      throw new Error(\"Login failed\");\n    }\n\n    const userData = await response.json();\n    console.log(\"User data on login:\", userData);\n\n    return userData;\n  }\n);\n\nexport const autoLogin = createAsyncThunk(\"user/autoLogin\", async () => {\n  const username = localStorage.getItem(\"username\");\n  const token = localStorage.getItem(\"token\");\n  const response = await fetch(`${BASE_URL}/users/${username}?token=${token}`, {\n    method: \"GET\",\n  });\n  if (!response.ok) {\n    throw new Error(\"Login failed\");\n  }\n\n  const userData = await response.json();\n  console.log(\"User data on login:\", userData);\n\n  return userData;\n});\n\nexport default loginUser;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}